import{f as c,c as d,a as l}from"./products-data--zIP1wZ_.js";class u{constructor(){this.currentCategory=null,this.currentProducts=[],this.filteredProducts=[],this.init()}init(){const e=new URLSearchParams(window.location.search);if(this.currentCategory=e.get("category"),!this.currentCategory){window.location.href="index.html";return}this.initMenu(),this.initSearch(),this.loadCategoryData()}initMenu(){const e=document.getElementById("menu-button"),t=document.getElementById("close-menu-button"),s=document.getElementById("menu"),o=document.getElementById("menu-overlay"),r=()=>{const n=!s.classList.contains("menu-closed");s.classList.toggle("menu-closed"),o.classList.toggle("menu-closed"),n?document.body.style.overflow="":document.body.style.overflow="hidden"},i=()=>{s.classList.add("menu-closed"),o.classList.add("menu-closed"),document.body.style.overflow=""};e&&e.addEventListener("click",r),t&&t.addEventListener("click",r),o&&o.addEventListener("click",i),document.addEventListener("keydown",n=>{n.key==="Escape"&&!s.classList.contains("menu-closed")&&i()}),document.querySelectorAll(".menu-item[data-category]").forEach(n=>{n.addEventListener("click",()=>{const a=n.getAttribute("data-category");a===this.currentCategory?i():window.location.href=`category.html?category=${encodeURIComponent(a)}`})})}initSearch(){const e=document.getElementById("search-input");if(document.getElementById("search-dropdown"),!e)return;let t;e.addEventListener("input",s=>{clearTimeout(t);const o=s.target.value.trim();t=setTimeout(()=>{o.length===0?(this.hideSearchDropdown(),this.showAllProducts()):this.performSearch(o)},300)}),document.addEventListener("click",s=>{s.target.closest(".search-container")||this.hideSearchDropdown()})}performSearch(e){const t=this.currentProducts.filter(s=>s.title.toLowerCase().includes(e.toLowerCase())||s.category.toLowerCase().includes(e.toLowerCase()));this.filteredProducts=t,this.displayProducts(t),t.length>0?this.showSearchDropdown(t.slice(0,5)):this.showNoSearchResults()}showSearchDropdown(e){const t=document.getElementById("search-dropdown");t&&(t.innerHTML="",e.forEach(s=>{const o=this.createSearchSuggestion(s);t.appendChild(o)}),t.classList.add("show"))}createSearchSuggestion(e){const t=document.createElement("div");t.className="search-suggestion";let s=`<span class="search-suggestion-price">${c(e.price)}</span>`;return e.oldPrice&&(s=`<span class="search-suggestion-price">${c(e.price)} <span class="category-product-price-old">${c(e.oldPrice,"₽",!0)}</span></span>`),t.innerHTML=`
      <img src="${e.images[0]}" alt="${e.title}" />
      <div class="search-suggestion-content">
        <div class="search-suggestion-title">${e.title}</div>
        <div class="search-suggestion-category">${e.category}</div>
        ${s}
      </div>
    `,t.addEventListener("click",()=>{window.location.href=`product.html?product=${e.id}`}),t}showNoSearchResults(){const e=document.getElementById("search-dropdown");e&&(e.innerHTML='<div class="no-results">Товары не найдены</div>',e.classList.add("show"))}hideSearchDropdown(){const e=document.getElementById("search-dropdown");e&&e.classList.remove("show")}showAllProducts(){this.displayProducts(this.currentProducts)}loadCategoryData(){const e=d[this.currentCategory];if(!e){window.location.href="index.html";return}document.title=`${e.name} - App`;const t=document.getElementById("category-title");t&&(t.textContent=e.name),this.currentProducts=l(this.currentCategory),this.displayProducts(this.currentProducts)}displayProducts(e){const t=document.getElementById("category-products"),s=document.getElementById("no-products");if(t){if(t.innerHTML="",e.length===0){s&&(s.style.display="block");return}s&&(s.style.display="none"),e.forEach(o=>{const r=this.createProductCard(o);t.appendChild(r)})}}createProductCard(e){const t=document.createElement("div");t.className="category-product-card";let s=`<span class="category-product-price-current">${c(e.price)}</span>`;return e.oldPrice&&(s+=`<span class="category-product-price-old">${c(e.oldPrice,"₽",!0)}</span>`),t.innerHTML=`
      <img src="${e.images[0]}" alt="${e.title}" />
      <div class="category-product-title">${e.title}</div>
      <div class="category-product-category">${e.category}</div>
      <div class="category-product-price">${s}</div>
    `,t.addEventListener("click",()=>{window.location.href=`product.html?product=${e.id}`}),t}}new u;
