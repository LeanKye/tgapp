<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script type='text/javascript' src='https://merchant.web.money/conf/lib/widgets/wmApp.js?v=1.6' onerror="console.error('Ошибка загрузки WebMoney скрипта')" onload="console.log('WebMoney скрипт успешно загружен')"></script>
    <script>
      // Проверка загрузки WebMoney скрипта
      console.log('Проверка доступности WebMoney:', {
        webmoney: !!window.webmoney,
        widgets: !!(window.webmoney && window.webmoney.widgets)
      });
      
      // Проверяем окружение
      const isTelegramWebApp = window.Telegram && window.Telegram.WebApp;
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      
      console.log('Окружение:', {
        isTelegramWebApp,
        isMobile,
        userAgent: navigator.userAgent
      });
      
      // Функция для загрузки WebMoney скрипта
      function loadWebMoneyScript() {
        if (!window.webmoney) {
          console.log('Попытка загрузки WebMoney скрипта');
          
          if (isTelegramWebApp && isMobile) {
            console.log('Мобильное приложение Telegram - используем специальную загрузку');
            
            // Попытка 1: Стандартная загрузка
            const script1 = document.createElement('script');
            script1.type = 'text/javascript';
            script1.src = 'https://merchant.web.money/conf/lib/widgets/wmApp.js?v=1.6';
            script1.onload = () => {
              console.log('WebMoney скрипт загружен для мобильного Telegram');
              console.log('WebMoney после загрузки:', {
                webmoney: !!window.webmoney,
                widgets: !!(window.webmoney && window.webmoney.widgets)
              });
            };
            script1.onerror = () => {
              console.log('Стандартная загрузка не удалась для мобильного Telegram');
              
              // Попытка 2: Без версии
              const script2 = document.createElement('script');
              script2.type = 'text/javascript';
              script2.src = 'https://merchant.web.money/conf/lib/widgets/wmApp.js';
              script2.onload = () => {
                console.log('WebMoney скрипт загружен без версии для мобильного Telegram');
              };
              script2.onerror = () => {
                console.log('Все попытки загрузки WebMoney для мобильного Telegram не удались');
              };
              document.head.appendChild(script2);
            };
            document.head.appendChild(script1);
          } else {
            // Стандартная загрузка для десктопа
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = 'https://merchant.web.money/conf/lib/widgets/wmApp.js?v=1.6';
            script.onload = () => {
              console.log('WebMoney скрипт загружен альтернативным способом');
              console.log('WebMoney после альтернативной загрузки:', {
                webmoney: !!window.webmoney,
                widgets: !!(window.webmoney && window.webmoney.widgets)
              });
            };
            script.onerror = () => console.error('Ошибка альтернативной загрузки WebMoney скрипта');
            document.head.appendChild(script);
          }
        }
      }
      
      // Альтернативная загрузка WebMoney скрипта если основной не загрузился
      setTimeout(() => {
        console.log('Проверка WebMoney через 2 секунды:', {
          webmoney: !!window.webmoney,
          widgets: !!(window.webmoney && window.webmoney.widgets)
        });
        
        loadWebMoneyScript();
      }, 2000);
      
      // Дополнительная проверка через 5 секунд
      setTimeout(() => {
        console.log('Финальная проверка WebMoney через 5 секунд:', {
          webmoney: !!window.webmoney,
          widgets: !!(window.webmoney && window.webmoney.widgets)
        });
      }, 5000);
    </script>
    <title>Product</title>
</head>

<body class="preload">
    <div class="product">
        <div class="product-cover">
            <div class="swiper">
                <div class="swiper-wrapper">
                    <!-- Слайды будут добавлены JavaScript-ом -->
                </div>
            </div>
        </div>
        <div class="container">
            <div class="labels">
                <!-- Лейблы будут добавлены JavaScript-ом -->
            </div>
            <h1 class="title">
                Загрузка...
            </h1>
            <div class="category text-gray">Загрузка...</div>
            <div class="price">
                <span class="price-value">Загрузка...</span>
                <span class="price-old text-gray" style="display: none;">0</span>
                <span class="price-discount" style="display: none;">0%</span>
                <div class="price-usdt text-gray">от 0.00 USDT</div>
                <div class="payment-methods">
                    {paymentMethods}
                </div>
            </div>
        </div>
        <div class="container" id="checkout">
            <div class="checkout-header" id="checkout-toggle">
                <span id="checkout-header-text">Аккаунт</span>
                <div class="checkout-arrow">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 9L12 16L5 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </div>
            <div class="button-group variant-group" id="variant-group">
                <!-- Содержимое будет добавлено JavaScript-ом -->
            </div>
            <div class="button-group period-group" id="period-group">
                <!-- Содержимое будет добавлено JavaScript-ом -->
            </div>
            <div class="button-group edition-group" id="edition-group">
                <!-- Содержимое будет добавлено JavaScript-ом -->
            </div>
        </div>
        <div class="container instruction">
            <div class="instruction-title">
                Перейти к просмотру
            </div>
            <div class="instruction-subtitle">
                Инструкция по установке
            </div>
        </div>
        <div class="container">
            <div class="tabs">
                <div class="tab tab-selected">
                    Описание
                </div>
                <div class="tab">
                    Системные требования
                </div>
            </div>
            <div class="tabs-content">
                Загрузка описания товара...
            </div>
        </div>
    </div>
    <button class="add-to-cart reset-Button">Купить</button>
    

    
    <script type="module" src="/src/telegram-webapp.js"></script>
    <script type="module" src="/src/bounce-scroll.js"></script>
    <script type="module" src="/src/product.js"></script>
    <script>
      // Убираем preload класс и показываем контент после загрузки
      document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
          document.body.classList.remove('preload');
          document.body.classList.add('loaded');
        }, 100);
      });
    </script>
</body>

</html>