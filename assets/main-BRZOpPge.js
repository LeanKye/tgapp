import{g as l,f as c,c as d}from"./products-data--MUGIqBM.js";const p=document.getElementById("menu-button"),g=document.getElementById("close-menu-button"),a=document.getElementById("menu"),h=document.getElementById("menu-overlay"),u=()=>{const i=!a.classList.contains("menu-closed");a.classList.toggle("menu-closed"),h.classList.toggle("menu-closed"),i?document.body.style.overflow="":document.body.style.overflow="hidden"},m=()=>{a.classList.add("menu-closed"),h.classList.add("menu-closed"),document.body.style.overflow=""};p.addEventListener("click",u);g.addEventListener("click",u);h.addEventListener("click",m);document.addEventListener("keydown",i=>{i.key==="Escape"&&!a.classList.contains("menu-closed")&&m()});function v(i){const t=document.createElement("div");t.className="category-product-card";let e=`<span class="category-product-price-current">${c(i.price)}</span>`;return i.oldPrice&&(e+=`<span class="category-product-price-old">${c(i.oldPrice,"₽",!0)}</span>`),t.innerHTML=`
    <img src="${i.images[0]}" alt="${i.title}" />
    <div class="category-product-title">${i.title}</div>
    <div class="category-product-category">${i.category}</div>
    <div class="category-product-price">${e}</div>
  `,t.addEventListener("click",()=>{window.location.href=`product.html?product=${i.id}`}),t}function f(){const i=document.querySelector(".category-products-slider"),t=l();i.innerHTML="",t.forEach(e=>{const s=v(e);i.appendChild(s)}),setTimeout(()=>{i.scrollLeft=0},0)}function w(){const i=document.getElementById("categories-grid");i&&(i.innerHTML="",Object.values(d).forEach((t,e)=>{const s=S(t,e);i.appendChild(s)}))}function S(i,t){const e=document.createElement("div");return e.className="category-card",e.style.backgroundImage=`url(${i.image})`,t===Object.keys(d).length-1&&(e.style.gridColumn="span 2"),e.innerHTML=`
    <div class="category-card-content">
      <div class="category-card-title">${i.name}</div>
    </div>
  `,e.addEventListener("click",()=>{window.location.href=`category.html?category=${encodeURIComponent(i.name)}`}),e}function E(){document.querySelectorAll(".menu-item").forEach(t=>{t.addEventListener("click",()=>{const e=t.textContent.trim();window.location.href=`category.html?category=${encodeURIComponent(e)}`})})}class y{constructor(){this.slider=document.getElementById("bannerSlider"),this.originalBanners=Array.from(this.slider.querySelectorAll(".banner-item")),this.totalOriginalBanners=this.originalBanners.length,this.currentIndex=1,this.gap=0,this.isTransitioning=!1,this.touchStartX=0,this.touchEndX=0,this.touchStartY=0,this.touchEndY=0,this.minSwipeDistance=50,this.isSwipeInProgress=!1,this.isMouseDown=!1,this.autoSlideInterval=null,this.autoSlideDelay=5e3,this.pauseDuration=1e4,this.pauseTimer=null,this.init()}init(){this.createCyclicClones(),this.allBanners=Array.from(this.slider.querySelectorAll(".banner-item")),this.setActiveWithoutTransition(this.currentIndex),this.originalBanners.forEach((t,e)=>{t.addEventListener("click",()=>{this.setActive(e+1,!0)})}),this.startAutoSlide(),this.slider.addEventListener("transitionend",t=>{this.handleTransitionEnd(t)}),this.initTouchEvents()}createCyclicClones(){const t=this.originalBanners[this.totalOriginalBanners-1].cloneNode(!0);t.classList.remove("active"),this.slider.insertBefore(t,this.slider.firstChild);const e=this.originalBanners[0].cloneNode(!0);e.classList.remove("active"),this.slider.appendChild(e)}setActive(t,e=!1){this.isTransitioning||t<0||t>=this.allBanners.length||t!==this.currentIndex&&(this.isTransitioning=!0,e&&this.pauseAutoSlide(),this.allBanners.forEach(s=>{s.classList.remove("active")}),this.allBanners[t].classList.add("active"),this.currentIndex=t,this.centerActiveSlide())}setActiveWithoutTransition(t){this.slider.style.transition="none",this.allBanners.forEach(e=>{e.classList.remove("active")}),this.allBanners[t].classList.add("active"),this.currentIndex=t,this.centerActiveSlide(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.slider.style.transition="transform 0.3s ease",this.isTransitioning=!1})})}getBannerWidth(){if(this.allBanners&&this.allBanners.length>0)return this.allBanners[0].offsetWidth;const t=window.innerWidth;return t<=375?Math.min(t-60,300):t<=768?Math.min(t-70,400):t>=1024?400:Math.min(t-80,350)}centerActiveSlide(){const t=this.slider.parentElement.offsetWidth,e=this.getBannerWidth(),s=(t-e)/2,n=this.currentIndex*(e+this.gap),r=s-n;this.slider.style.transform=`translateX(${r}px)`}handleTransitionEnd(t){t&&t.target!==this.slider||this.isTransitioning&&(this.isTransitioning=!1,this.currentIndex===0?this.setActiveWithoutTransition(this.totalOriginalBanners):this.currentIndex===this.totalOriginalBanners+1&&this.setActiveWithoutTransition(1))}nextSlide(t=!1){let e=this.currentIndex+1;e>=this.allBanners.length&&(e=0),this.setActive(e,t)}prevSlide(t=!1){let e=this.currentIndex-1;e<0&&(e=this.allBanners.length-1),this.setActive(e,t)}initTouchEvents(){const t=this.slider.parentElement;t.addEventListener("touchstart",e=>{this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY},{passive:!0}),t.addEventListener("touchend",e=>{this.touchEndX=e.changedTouches[0].clientX,this.touchEndY=e.changedTouches[0].clientY,this.handleSwipe()},{passive:!0}),this.allBanners.forEach(e=>{e.addEventListener("touchstart",s=>{this.touchStartX=s.touches[0].clientX,this.touchStartY=s.touches[0].clientY,this.isSwipeInProgress=!1},{passive:!0}),e.addEventListener("touchend",s=>{this.touchEndX=s.changedTouches[0].clientX,this.touchEndY=s.changedTouches[0].clientY;const n=Math.abs(this.touchStartX-this.touchEndX),r=Math.abs(this.touchStartY-this.touchEndY);n>r&&n>this.minSwipeDistance&&(this.isSwipeInProgress=!0,setTimeout(()=>{this.isSwipeInProgress=!1},100)),this.handleSwipe()},{passive:!0}),e.addEventListener("touchmove",s=>{if(!this.touchStartX||!this.touchStartY)return;const n=s.touches[0],r=Math.abs(n.clientX-this.touchStartX),o=Math.abs(n.clientY-this.touchStartY);r>o&&r>20&&o<10&&s.preventDefault()},{passive:!1}),e.addEventListener("click",s=>{this.isSwipeInProgress&&(s.preventDefault(),s.stopPropagation())},{capture:!0})}),t.addEventListener("mousedown",e=>{this.touchStartX=e.clientX,this.isMouseDown=!0,t.addEventListener("mousemove",this.handleMouseMove.bind(this))}),t.addEventListener("mouseup",e=>{this.touchEndX=e.clientX,this.isMouseDown=!1,t.removeEventListener("mousemove",this.handleMouseMove.bind(this)),this.handleSwipe()}),this.allBanners.forEach(e=>{e.addEventListener("mousedown",s=>{this.touchStartX=s.clientX,this.isMouseDown=!0}),e.addEventListener("mouseup",s=>{this.touchEndX=s.clientX,this.isMouseDown=!1,this.handleSwipe()})})}handleMouseMove(t){t.preventDefault()}handleSwipe(){if(!this.touchStartX||!this.touchEndX)return;const t=this.touchStartX-this.touchEndX,e=this.touchStartY-this.touchEndY;Math.abs(t)>Math.abs(e)&&Math.abs(t)>this.minSwipeDistance&&(t>0?this.nextSlide(!0):this.prevSlide(!0)),this.touchStartX=null,this.touchEndX=null,this.touchStartY=null,this.touchEndY=null}startAutoSlide(){this.autoSlideInterval&&clearInterval(this.autoSlideInterval),this.autoSlideInterval=setInterval(()=>{this.isTransitioning||this.nextSlide(!1)},this.autoSlideDelay)}stopAutoSlide(){this.autoSlideInterval&&(clearInterval(this.autoSlideInterval),this.autoSlideInterval=null)}pauseAutoSlide(){this.stopAutoSlide(),this.pauseTimer&&clearTimeout(this.pauseTimer),this.pauseTimer=setTimeout(()=>{this.startAutoSlide()},this.pauseDuration)}destroy(){this.stopAutoSlide(),this.pauseTimer&&clearTimeout(this.pauseTimer)}}class I{constructor(){this.searchInput=document.getElementById("search-input"),this.searchDropdown=document.getElementById("search-dropdown"),this.products=l(),this.selectedIndex=-1,this.currentResults=[],this.searchTimeout=null,this.init()}init(){this.searchInput.addEventListener("input",t=>{this.handleInput(t.target.value)}),this.searchInput.addEventListener("keydown",t=>{this.handleKeydown(t)}),document.addEventListener("click",t=>{t.target.closest(".search-container")||this.hideDropdown()}),this.searchInput.addEventListener("focus",()=>{this.searchInput.value.trim()&&this.handleInput(this.searchInput.value)})}handleInput(t){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.performSearch(t)},200)}performSearch(t){const e=t.trim().toLowerCase();if(e.length===0){this.hideDropdown();return}this.currentResults=this.products.filter(s=>s.title.toLowerCase().includes(e)||s.category.toLowerCase().includes(e)),this.selectedIndex=-1,this.showResults()}showResults(){if(this.currentResults.length===0){this.showNoResults();return}this.searchDropdown.innerHTML="",this.currentResults.forEach((t,e)=>{const s=this.createSuggestion(t,e);this.searchDropdown.appendChild(s)}),this.showDropdown()}createSuggestion(t,e){const s=document.createElement("div");return s.className="search-suggestion",s.dataset.index=e,s.innerHTML=`
      <img src="${t.images[0]}" alt="${t.title}" />
      <div class="search-suggestion-content">
        <div class="search-suggestion-title">${t.title}</div>
        <div class="search-suggestion-category">${t.category}</div>
      </div>
      <div class="search-suggestion-price">${c(t.price)}</div>
    `,s.addEventListener("click",()=>{this.selectProduct(t)}),s}showNoResults(){this.searchDropdown.innerHTML='<div class="no-results">Товары не найдены</div>',this.showDropdown()}selectProduct(t){this.searchInput.value="",this.hideDropdown(),window.location.href=`product.html?product=${t.id}`}handleKeydown(t){if(this.currentResults.length!==0)switch(t.key){case"ArrowDown":t.preventDefault(),this.selectedIndex=Math.min(this.selectedIndex+1,this.currentResults.length-1),this.updateSelection();break;case"ArrowUp":t.preventDefault(),this.selectedIndex=Math.max(this.selectedIndex-1,-1),this.updateSelection();break;case"Enter":t.preventDefault(),this.selectedIndex>=0&&this.selectProduct(this.currentResults[this.selectedIndex]);break;case"Escape":this.hideDropdown(),this.searchInput.blur();break}}updateSelection(){const t=this.searchDropdown.querySelectorAll(".search-suggestion");if(t.forEach((e,s)=>{e.classList.toggle("selected",s===this.selectedIndex)}),this.selectedIndex>=0){const e=t[this.selectedIndex];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}}showDropdown(){this.searchDropdown.classList.add("show")}hideDropdown(){this.searchDropdown.classList.remove("show"),this.selectedIndex=-1}}class L{constructor(){this.switchesContainer=document.getElementById("ps-plus-switches"),this.switchesContainer&&(this.slider=this.switchesContainer.querySelector(".toggle-switch-slider"),this.inputs=this.switchesContainer.querySelectorAll('input[type="radio"]'),this.init())}init(){this.inputs.forEach((e,s)=>{e.addEventListener("change",()=>{e.checked&&this.moveSlider(s)})});const t=this.switchesContainer.querySelector('input[type="radio"]:checked');if(t){const e=Array.from(this.inputs).indexOf(t);this.moveSlider(e)}window.addEventListener("resize",()=>{const e=this.switchesContainer.querySelector('input[type="radio"]:checked');if(e){const s=Array.from(this.inputs).indexOf(e);this.moveSlider(s)}})}moveSlider(t){const r=(this.switchesContainer.offsetWidth-6)/3,o=t*r;this.slider.style.transform=`translateX(${o}px)`,this.slider.style.transition="transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)"}}document.addEventListener("DOMContentLoaded",()=>{const i=new y;new I,new L,f(),w(),E(),setTimeout(()=>{const t=document.querySelector(".category-products-slider");t&&(t.scrollLeft=0)},100),window.addEventListener("resize",()=>{setTimeout(()=>{i.centerActiveSlide()},100)})});
